---
layout: post
category: Publish
title: 一种Android多语言资源文件的集成方案
tagline:
tag: [Android系统原理]
---

# 1. 背景

Android的资源管理方式，使得应用程序能够方便地完成多语言适配。应用程序只需要关心资源名称是什么，譬如，应用程序在使用字符串资源时，只需要使用 **R.string.app_name**，在不同的语言环境下，这个字符可以显示出不同的内容。应用程序需要做的，就是按照Android的命名规范，把多语言的资源文件放在特定的目录下，Android系统层会完成资源名称到实际资源的映射。

对于整个Android固件而言，包括数十个应用程序，还有框架层的公共资源，多语言适配就上升到了系统层面的问题：如何统筹各个模块的多语言资源适配？

- 首先，这是一个业务相关的话题，在做Android系统开发时，一般都会以Android模块为单位，划分为不同业务组进行协同开发，通常，框架层是一个业务组，电话、短信等是一个业务组，视频，音乐又是另外的业务组，不同业务组是分开横向管理的，各自对自身业务负责。当涉及到多语言翻译时，又会有一个新的业务组，纵深到已有的各个业务组，专门处理其多语言资源的翻译。这就形成了一个横纵相连的组织结构，多语言翻译都是交由第三方专业机构完成，这个纵向的多语言业务组的职责就是按照Android的规范来统筹集成翻译资源。

- 然后，我们来探讨一下技术相关的话题，多语言资源需要合入已有模块的代码库，并且多语言资源也需要及时地跟进代码的变化，譬如，已有模块新增了字符串，那么，这些字符串的翻译也需要尽快的完成。当已有模块达到发布状态，通常会拉出发布分支(Release分支)，意味着该模块已经完成了拟定的需求，并且已经适配了多语言。这时候如果发现存在翻译错误，则需要在发布分支上进行修复。这是多语言资源集成的最常见的技术方案。

- 最后，本文提出一种方案，适用于Android系统开发时，各业务模块横纵协作的场景，能够提升多语言翻译资源的集成效率。上文提到的技术方案并非适用所有的业务场景。笔者就见过应用程序(电话、短信、视频等)不随系统拉发布分支，而是独立以二进制的形式预装(PREBUILT)到整个固件的的业务场景，当固件拉取发布分支后，意味着多语言翻译已经完成，但这时，应用程序是已经编译完成的二进制的APK文件